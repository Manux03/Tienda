<!DOCTYPE html>
<html lang="en">
<head>
    {% load static %}
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" />
    
    <link href="{% static 'css/carrito.css'%}" rel="stylesheet" />
</head>
<body>
    {% include "core/navbar.html"%}
    <div class="container bg-white rounded-top mt-5" id="zero-pad">
        <div class="row d-flex justify-content-center">
            <div class="col-lg-10 col-12 pt-3">
                <div class="d-flex">
                    <div class="pt-1"><h4>Mis Productos</h4></div>                                 
                </div>
                <div class="d-flex flex-column pt-4">
                    <div><h5 class="text-uppercase font-weight-normal">Carrito de Compras</h5></div>
                    <div class="font-weight-normal">{{total_productos}} Items</div>
                </div>
                <div class="d-flex flex-row px-lg-5 mx-lg-5 mobile" id="heading">
                    <div class="px-lg-5 mr-lg-5" id="produc">PRODUCTOS</div>
                    <div class="px-lg-5 ml-lg-5" id="prc">PRECIO</div>
                    <div class="px-lg-5 ml-lg-1" id="quantity">CANTIDAD</div>
                    <div class="px-lg-5 ml-lg-3" id="total">TOTAL</div>
                </div>
                {% if request.session.carrito.items %}
                {% for key, value in request.session.carrito.items %}
                <div class="d-flex flex-row justify-content-between align-items-center pt-lg-4 pt-2 pb-3 border-bottom mobile">
                    <div class="d-flex flex-row align-items-center">
                        <div><img src="{{value.imagen}}" width="150" height="150" alt="" id="image"></div>
                        <div class="d-flex flex-column pl-md-3 pl-1">
                            <div><h6>{{value.nombre}}</h6></div>
                            <div >Art.No:<span class="pl-2">{{value.producto_id}}</span></div>
                            <div>Modelo:<span class="pl-3">{{value.modelo}}</span></div>
                        </div>                    
                    </div>
                    <div class="pl-md-0 pl-1"><b>$ {{value.precio}}</b></div>
                    <div class="pl-md-0 pl-2">
                        <a class="btn btn-outline-dark flex-shrink-0" href="{% url 'Sub' value.producto_id %}" role="button">
                            <span class="btn-label"><i class=""></i></span>-</a><span class="px-md-3 px-1">{{value.cantidad}}</span>            <a class="btn btn-outline-dark flex-shrink-0" href="{% url 'Add' value.producto_id %}" role="button">
                                <span class="btn-label"><i class=""></i></span>+</a>
                    </div>
                    <div class="pl-md-0 pl-1"><b>${{value.acumulado}}</b></div>
                    <div class="close" href="{% url 'Del' value.producto_id %}">&times;</div>
                </div>
                {% endfor %}
                {% else %}
                <tr>
                    <td colspan="3">
                        <div class="alert alert-danger text-center"> Sin Productos </div>
                    </td>
                </tr>
                {% endif %}
            </div>
        </div>
    </div>
    <div class="container bg-light rounded-bottom py-4" id="zero-pad">
        <div class="row d-flex justify-content-center">
            <div class="col-lg-10 col-12">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <a href="{% url 'homex' %}">
                        <button class="btn btn-sm bg-light border border-dark">Ir atras</button>
                        </a>
                    </div>
                    <div class="px-md-0 px-1" id="footer-font">
                        <b class="pl-md-4">SubTotal =<span class="pl-md-4">${{total_carrito}}</span></b>
                    </div>
                    <div>
                        <a href="">
                            <p>{{ url }}</p>
                            <p>{{ token }}</p>
                            <button onclick={PostApi} class="btn btn-sm bg-dark text-white px-lg-5 px-3">Continuar</button>
                        </a>
                    </div>
                    <br>
                    {% csrf_token %}
                    <form action="{{ url }}" method="POST" {% csrf_token %}>
                        <input type="hidden" name="token_ws" value="{{ token }}">
                        <input type="submit" value="Ejecutar Pago con Webpay">
                        </form>
                    <br>
                </div>
            </div>
        </div>
    </div>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{% static 'js/APITBK.js'%} "></script>
</body>
</html>